{"version":3,"sources":["dist/penpal.js"],"names":["Penpal","exports","HANDSHAKE","HANDSHAKE_REPLY","CALL","REPLY","FULFILLED","REJECTED","MESSAGE","DATA_CLONE_ERROR","ERR_CONNECTION_DESTROYED","ERR_CONNECTION_TIMEOUT","ERR_NOT_IN_IFRAME","ERR_IFRAME_ALREADY_ATTACHED_TO_DOM","CHECK_IFRAME_IN_DOC_INTERVAL","DEFAULT_PORTS","t","i","URL_REGEX","o","v","u","l","Promise","window","e","debug","generateId","id","log","_console","_len","arguments","length","args","Array","_key","console","apply","concat","getOriginFromUrl","url","location","document","regexResult","exec","protocol","hostname","port","portSuffix","DestructionPromise","executor","handlers","forEach","handler","then","push","serializeError","_ref","name","message","stack","deserializeError","obj","deserializedError","Error","Object","keys","key","connectCallSender","callSender","info","methodNames","destroy","destructionPromise","localName","local","remote","remoteOrigin","destroyed","createMethodProxy","methodName","_len2","_key2","closed","error","code","resolve","reject","handleMessageEvent","event","source","origin","data","penpal","removeEventListener","returnValue","returnValueIsError","resolution","addEventListener","postMessage","p","O","N","reduce","api","connectCallReceiver","methods","_event$data","createPromiseHandler","T","err","C","connectToChild","_ref2","appendTo","iframe","_ref2$methods","timeout","parentNode","connectionDestructionPromise","resolveConnectionDestructionPromise","parent","createElement","src","childOrigin","promise","resolveConnectionPromise","connectionTimeoutId","undefined","setTimeout","receiverMethodNames","destroyCallReceiver","handleMessage","child","contentWindow","R","m","s","h","callReceiverDestructionPromise","resolveCallReceiverDestructionPromise","receiverMethodName","clearTimeout","body","appendChild","checkIframeInDocIntervalId","setInterval","contains","clearInterval","removeChild","P","A","k","connectToParent","_ref3","_ref3$parentOrigin","parentOrigin","_ref3$methods","top","default"],"mappings":"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"}